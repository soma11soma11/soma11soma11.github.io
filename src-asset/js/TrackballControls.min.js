THREE.TrackballControls=function(e,t){var c=this,i={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var o=new THREE.Vector3,a=i.NONE,n=i.NONE,s=new THREE.Vector3,r=new THREE.Vector2,p=new THREE.Vector2,h=new THREE.Vector3,d=0,u=new THREE.Vector2,E=new THREE.Vector2,m=0,l=0,g=new THREE.Vector2,y=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var v={type:"change"},w={type:"start"},T={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var b,f,O,R,H,L,V,k,N,j,A,D,Y=(b=new THREE.Vector2,function(e,t){return b.set((e-c.screen.left)/c.screen.width,(t-c.screen.top)/c.screen.height),b}),C=(f=new THREE.Vector2,function(e,t){return f.set((e-.5*c.screen.width-c.screen.left)/(.5*c.screen.width),(c.screen.height+2*(c.screen.top-t))/c.screen.width),f});function P(e){!1!==c.enabled&&(window.removeEventListener("keydown",P),(n=a)===i.NONE&&(e.keyCode!==c.keys[i.ROTATE]||c.noRotate?e.keyCode!==c.keys[i.ZOOM]||c.noZoom?e.keyCode!==c.keys[i.PAN]||c.noPan||(a=i.PAN):a=i.ZOOM:a=i.ROTATE))}function X(e){!1!==c.enabled&&(a=n,window.addEventListener("keydown",P,!1))}function M(e){!1!==c.enabled&&(e.preventDefault(),e.stopPropagation(),a===i.NONE&&(a=e.button),a!==i.ROTATE||c.noRotate?a!==i.ZOOM||c.noZoom?a!==i.PAN||c.noPan||(g.copy(Y(e.pageX,e.pageY)),y.copy(g)):(u.copy(Y(e.pageX,e.pageY)),E.copy(u)):(p.copy(C(e.pageX,e.pageY)),r.copy(p)),document.addEventListener("mousemove",Z,!1),document.addEventListener("mouseup",S,!1),c.dispatchEvent(w))}function Z(e){!1!==c.enabled&&(e.preventDefault(),e.stopPropagation(),a!==i.ROTATE||c.noRotate?a!==i.ZOOM||c.noZoom?a!==i.PAN||c.noPan||y.copy(Y(e.pageX,e.pageY)):E.copy(Y(e.pageX,e.pageY)):(r.copy(p),p.copy(C(e.pageX,e.pageY))))}function S(e){!1!==c.enabled&&(e.preventDefault(),e.stopPropagation(),a=i.NONE,document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",S),c.dispatchEvent(T))}function x(e){if(!1!==c.enabled&&!0!==c.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:u.y-=.025*e.deltaY;break;case 1:u.y-=.01*e.deltaY;break;default:u.y-=25e-5*e.deltaY}c.dispatchEvent(w),c.dispatchEvent(T)}}function z(e){if(!1!==c.enabled){switch(e.touches.length){case 1:a=i.TOUCH_ROTATE,p.copy(C(e.touches[0].pageX,e.touches[0].pageY)),r.copy(p);break;default:a=i.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;l=m=Math.sqrt(t*t+o*o);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;g.copy(Y(n,s)),y.copy(g)}c.dispatchEvent(w)}}function _(e){if(!1!==c.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:r.copy(p),p.copy(C(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;l=Math.sqrt(t*t+o*o);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;y.copy(Y(n,s))}}function q(e){if(!1!==c.enabled){switch(e.touches.length){case 0:a=i.NONE;break;case 1:a=i.TOUCH_ROTATE,p.copy(C(e.touches[0].pageX,e.touches[0].pageY)),r.copy(p)}c.dispatchEvent(T)}}function F(e){!1!==c.enabled&&e.preventDefault()}this.rotateCamera=(R=new THREE.Vector3,H=new THREE.Quaternion,L=new THREE.Vector3,V=new THREE.Vector3,k=new THREE.Vector3,N=new THREE.Vector3,function(){N.set(p.x-r.x,p.y-r.y,0),(O=N.length())?(s.copy(c.object.position).sub(c.target),L.copy(s).normalize(),V.copy(c.object.up).normalize(),k.crossVectors(V,L).normalize(),V.setLength(p.y-r.y),k.setLength(p.x-r.x),N.copy(V.add(k)),R.crossVectors(N,s).normalize(),O*=c.rotateSpeed,H.setFromAxisAngle(R,O),s.applyQuaternion(H),c.object.up.applyQuaternion(H),h.copy(R),d=O):!c.staticMoving&&d&&(d*=Math.sqrt(1-c.dynamicDampingFactor),s.copy(c.object.position).sub(c.target),H.setFromAxisAngle(h,d),s.applyQuaternion(H),c.object.up.applyQuaternion(H)),r.copy(p)}),this.zoomCamera=function(){var e;a===i.TOUCH_ZOOM_PAN?(e=m/l,m=l,s.multiplyScalar(e)):(1!==(e=1+(E.y-u.y)*c.zoomSpeed)&&0<e&&s.multiplyScalar(e),c.staticMoving?u.copy(E):u.y+=(E.y-u.y)*this.dynamicDampingFactor)},this.panCamera=(j=new THREE.Vector2,A=new THREE.Vector3,D=new THREE.Vector3,function(){j.copy(y).sub(g),j.lengthSq()&&(j.multiplyScalar(s.length()*c.panSpeed),D.copy(s).cross(c.object.up).setLength(j.x),D.add(A.copy(c.object.up).setLength(j.y)),c.object.position.add(D),c.target.add(D),c.staticMoving?g.copy(y):g.add(j.subVectors(y,g).multiplyScalar(c.dynamicDampingFactor)))}),this.checkDistances=function(){c.noZoom&&c.noPan||(s.lengthSq()>c.maxDistance*c.maxDistance&&(c.object.position.addVectors(c.target,s.setLength(c.maxDistance)),u.copy(E)),s.lengthSq()<c.minDistance*c.minDistance&&(c.object.position.addVectors(c.target,s.setLength(c.minDistance)),u.copy(E)))},this.update=function(){s.subVectors(c.object.position,c.target),c.noRotate||c.rotateCamera(),c.noZoom||c.zoomCamera(),c.noPan||c.panCamera(),c.object.position.addVectors(c.target,s),c.checkDistances(),c.object.lookAt(c.target),1e-6<o.distanceToSquared(c.object.position)&&(c.dispatchEvent(v),o.copy(c.object.position))},this.reset=function(){a=i.NONE,n=i.NONE,c.target.copy(c.target0),c.object.position.copy(c.position0),c.object.up.copy(c.up0),s.subVectors(c.object.position,c.target),c.object.lookAt(c.target),c.dispatchEvent(v),o.copy(c.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",F,!1),this.domElement.removeEventListener("mousedown",M,!1),this.domElement.removeEventListener("wheel",x,!1),this.domElement.removeEventListener("touchstart",z,!1),this.domElement.removeEventListener("touchend",q,!1),this.domElement.removeEventListener("touchmove",_,!1),document.removeEventListener("mousemove",Z,!1),document.removeEventListener("mouseup",S,!1),window.removeEventListener("keydown",P,!1),window.removeEventListener("keyup",X,!1)},this.domElement.addEventListener("contextmenu",F,!1),this.domElement.addEventListener("mousedown",M,!1),this.domElement.addEventListener("wheel",x,!1),this.domElement.addEventListener("touchstart",z,!1),this.domElement.addEventListener("touchend",q,!1),this.domElement.addEventListener("touchmove",_,!1),window.addEventListener("keydown",P,!1),window.addEventListener("keyup",X,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls;
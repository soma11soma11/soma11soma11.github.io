THREE.CSS3DObject=function(e){THREE.Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},THREE.CSS3DObject.prototype=Object.create(THREE.Object3D.prototype),THREE.CSS3DObject.prototype.constructor=THREE.CSS3DObject,THREE.CSS3DSprite=function(e){THREE.CSS3DObject.call(this,e)},THREE.CSS3DSprite.prototype=Object.create(THREE.CSS3DObject.prototype),THREE.CSS3DSprite.prototype.constructor=THREE.CSS3DSprite,THREE.CSS3DRenderer=function(){var r,n,d,p;console.log("THREE.CSS3DRenderer",THREE.REVISION);var m=new THREE.Matrix4,E={camera:{fov:0,style:""},objects:{}},S=document.createElement("div");S.style.overflow="hidden",this.domElement=S;var y=document.createElement("div");y.style.WebkitTransformStyle="preserve-3d",y.style.MozTransformStyle="preserve-3d",y.style.transformStyle="preserve-3d",S.appendChild(y);var u=/Trident/i.test(navigator.userAgent);function f(e){return Math.abs(e)<1e-10?0:e}function v(e,t){var r=e.elements,n="matrix3d("+f(r[0])+","+f(r[1])+","+f(r[2])+","+f(r[3])+","+f(-r[4])+","+f(-r[5])+","+f(-r[6])+","+f(-r[7])+","+f(r[8])+","+f(r[9])+","+f(r[10])+","+f(r[11])+","+f(r[12])+","+f(r[13])+","+f(r[14])+","+f(r[15])+")";return u?"translate(-50%,-50%)translate("+d+"px,"+p+"px)"+t+n:"translate(-50%,-50%)"+n}this.setClearColor=function(){},this.getSize=function(){return{width:r,height:n}},this.setSize=function(e,t){d=(r=e)/2,p=(n=t)/2,S.style.width=e+"px",S.style.height=t+"px",y.style.width=e+"px",y.style.height=t+"px"};var o,s,h=(o=new THREE.Vector3,s=new THREE.Vector3,function(e,t){return o.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(t.matrixWorld),o.distanceToSquared(s)});this.render=function(e,t){var r=t.projectionMatrix.elements[5]*p;E.camera.fov!==r&&(S.style.WebkitPerspective=r+"px",S.style.MozPerspective=r+"px",S.style.perspective=r+"px",E.camera.fov=r),e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld();var n,o,s,a,i,l="translateZ("+r+"px)"+(n=t.matrixWorldInverse,"matrix3d("+f((o=n.elements)[0])+","+f(-o[1])+","+f(o[2])+","+f(o[3])+","+f(o[4])+","+f(-o[5])+","+f(o[6])+","+f(o[7])+","+f(o[8])+","+f(-o[9])+","+f(o[10])+","+f(o[11])+","+f(o[12])+","+f(-o[13])+","+f(o[14])+","+f(o[15])+")"),c=l+"translate("+d+"px,"+p+"px)";E.camera.style===c||u||(y.style.WebkitTransform=c,y.style.MozTransform=c,y.style.transform=c,E.camera.style=c),function e(t,r,n){if(t instanceof THREE.CSS3DObject){var o;t instanceof THREE.CSS3DSprite?(m.copy(r.matrixWorldInverse),m.transpose(),m.copyPosition(t.matrixWorld),m.scale(t.scale),m.elements[3]=0,m.elements[7]=0,m.elements[11]=0,m.elements[15]=1,o=v(m,n)):o=v(t.matrixWorld,n);var s=t.element,a=E.objects[t.id]&&E.objects[t.id].style;void 0!==a&&a===o||(s.style.WebkitTransform=o,s.style.MozTransform=o,s.style.transform=o,E.objects[t.id]={style:o},u&&(E.objects[t.id].distanceToCameraSquared=h(r,t))),s.parentNode!==y&&y.appendChild(s)}for(var i=0,l=t.children.length;i<l;i++)e(t.children[i],r,n)}(e,t,l),u&&(s=e,a=Object.keys(E.objects).sort(function(e,t){return E.objects[e].distanceToCameraSquared-E.objects[t].distanceToCameraSquared}),i=a.length,s.traverse(function(e){var t=a.indexOf(e.id+"");-1!==t&&(e.element.style.zIndex=i-t)}))}};